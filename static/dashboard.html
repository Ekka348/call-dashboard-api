<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>CRM Dashboard</title>
  <style>
    body { font-family: Arial; background-color: #f8f8f8; padding: 30px; color: #333; }
    select, button { padding: 6px; font-size: 16px; margin-right: 10px; }
    iframe { width: 100%; height: 600px; border: 1px solid #ccc; margin-top: 20px; border-radius: 8px; }
    .dark-mode body { background-color: #121212; color: #eee; }
    .dark-mode iframe { background-color: #000; }
  </style>
</head>
<body>
  <h2>üìä CRM Dashboard</h2>
  <label>–°—Ç–∞–¥–∏—è:</label>
  <select id="stage">
    <option>–ù–î–ó</option>
    <option>–ù–î–ó 2</option>
    <option>–ü–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å</option>
    <option>–ü—Ä–∏–≥–ª–∞—à–µ–Ω –∫ —Ä–µ–∫—Ä—É—Ç–µ—Ä—É</option>
  </select>

  <label>–ü–µ—Ä–∏–æ–¥:</label>
  <select id="range">
    <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
    <option value="week">–ù–µ–¥–µ–ª—è</option>
    <option value="month">–ú–µ—Å—è—Ü</option>
  </select>

  <button onclick="loadReport()">üîÅ –û–±–Ω–æ–≤–∏—Ç—å</button>
  <button onclick="toggleDark()">üåô –¢–µ–º–Ω–∞—è —Ç–µ–º–∞</button>

  <iframe id="reportFrame" src=""></iframe>

  <script>
    function loadReport() {
      const stage = document.getElementById("stage").value;
      const range = document.getElementById("range").value;
      const url = `/daily?label=${encodeURIComponent(stage)}&range=${range}`;
      document.getElementById("reportFrame").src = url;
    }

    function toggleDark() {
      document.body.classList.toggle("dark-mode");
    }

    window.onload = loadReport;
    setInterval(loadReport, 15000); // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫
  </script>
</body>
</html>
